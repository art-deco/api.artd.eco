function t(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function x(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:t(a)}}var y="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,B="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};
function C(a,b){if(b){var e=y;a=a.split(".");for(var g=0;g<a.length-1;g++){var h=a[g];h in e||(e[h]={});e=e[h]}a=a[a.length-1];g=e[a];b=b(g);b!=g&&null!=b&&B(e,a,{configurable:!0,writable:!0,value:b})}}
C("Promise",function(a){function b(c){this.b=0;this.g=void 0;this.a=[];var d=this.c();try{c(d.resolve,d.reject)}catch(f){d.reject(f)}}function e(){this.a=null}function g(c){return c instanceof b?c:new b(function(d){d(c)})}if(a)return a;e.prototype.b=function(c){if(null==this.a){this.a=[];var d=this;this.c(function(){d.g()})}this.a.push(c)};var h=y.setTimeout;e.prototype.c=function(c){h(c,0)};e.prototype.g=function(){for(;this.a&&this.a.length;){var c=this.a;this.a=[];for(var d=0;d<c.length;++d){var f=
c[d];c[d]=null;try{f()}catch(k){this.f(k)}}}this.a=null};e.prototype.f=function(c){this.c(function(){throw c;})};b.prototype.c=function(){function c(k){return function(n){f||(f=!0,k.call(d,n))}}var d=this,f=!1;return{resolve:c(this.w),reject:c(this.f)}};b.prototype.w=function(c){if(c===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof b)this.A(c);else{a:switch(typeof c){case "object":var d=null!=c;break a;case "function":d=!0;break a;default:d=!1}d?this.v(c):this.h(c)}};
b.prototype.v=function(c){var d=void 0;try{d=c.then}catch(f){this.f(f);return}"function"==typeof d?this.B(d,c):this.h(c)};b.prototype.f=function(c){this.i(2,c)};b.prototype.h=function(c){this.i(1,c)};b.prototype.i=function(c,d){if(0!=this.b)throw Error("Cannot settle("+c+", "+d+"): Promise already settled in state"+this.b);this.b=c;this.g=d;this.u()};b.prototype.u=function(){if(null!=this.a){for(var c=0;c<this.a.length;++c)l.b(this.a[c]);this.a=null}};var l=new e;b.prototype.A=function(c){var d=this.c();
c.j(d.resolve,d.reject)};b.prototype.B=function(c,d){var f=this.c();try{c.call(d,f.resolve,f.reject)}catch(k){f.reject(k)}};b.prototype.then=function(c,d){function f(m,r){return"function"==typeof m?function(v){try{k(m(v))}catch(w){n(w)}}:r}var k,n,p=new b(function(m,r){k=m;n=r});this.j(f(c,k),f(d,n));return p};b.prototype.catch=function(c){return this.then(void 0,c)};b.prototype.j=function(c,d){function f(){switch(k.b){case 1:c(k.g);break;case 2:d(k.g);break;default:throw Error("Unexpected state: "+
k.b);}}var k=this;null==this.a?l.b(f):this.a.push(f)};b.resolve=g;b.reject=function(c){return new b(function(d,f){f(c)})};b.race=function(c){return new b(function(d,f){for(var k=x(c),n=k.next();!n.done;n=k.next())g(n.value).j(d,f)})};b.all=function(c){var d=x(c),f=d.next();return f.done?g([]):new b(function(k,n){function p(v){return function(w){m[v]=w;r--;0==r&&k(m)}}var m=[],r=0;do m.push(void 0),r++,g(f.value).j(p(m.length-1),n),f=d.next();while(!f.done)})};return b});
function D(){D=function(){};y.Symbol||(y.Symbol=E)}function F(a,b){this.a=a;B(this,"description",{configurable:!0,writable:!0,value:b})}F.prototype.toString=function(){return this.a};var E=function(){function a(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new F("jscomp_symbol_"+(e||"")+"_"+b++,e)}var b=0;return a}();
function G(){D();var a=y.Symbol.iterator;a||(a=y.Symbol.iterator=y.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&B(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return H(t(this))}});G=function(){}}function H(a){G();a={next:a};a[y.Symbol.iterator]=function(){return this};return a}function I(){this.g=!1;this.b=null;this.c=void 0;this.a=1;this.i=0;this.f=null}function J(a){if(a.g)throw new TypeError("Generator is already running");a.g=!0}
I.prototype.h=function(a){this.c=a};function K(a,b){a.f={o:b,s:!0};a.a=a.i}I.prototype.return=function(a){this.f={return:a};this.a=this.i};function L(a,b,e){a.a=e;return{value:b}}function M(a){this.a=new I;this.b=a}function N(a,b){J(a.a);var e=a.a.b;if(e)return O(a,"return"in e?e["return"]:function(g){return{value:g,done:!0}},b,a.a.return);a.a.return(b);return R(a)}
function O(a,b,e,g){try{var h=b.call(a.a.b,e);if(!(h instanceof Object))throw new TypeError("Iterator result "+h+" is not an object");if(!h.done)return a.a.g=!1,h;var l=h.value}catch(c){return a.a.b=null,K(a.a,c),R(a)}a.a.b=null;g.call(a.a,l);return R(a)}function R(a){for(;a.a.a;)try{var b=a.b(a.a);if(b)return a.a.g=!1,{value:b.value,done:!1}}catch(e){a.a.c=void 0,K(a.a,e)}a.a.g=!1;if(a.a.f){b=a.a.f;a.a.f=null;if(b.s)throw b.o;return{value:b.return,done:!0}}return{value:void 0,done:!0}}
function S(a){this.next=function(b){J(a.a);a.a.b?b=O(a,a.a.b.next,b,a.a.h):(a.a.h(b),b=R(a));return b};this.throw=function(b){J(a.a);a.a.b?b=O(a,a.a.b["throw"],b,a.a.h):(K(a.a,b),b=R(a));return b};this.return=function(b){return N(a,b)};G();this[Symbol.iterator]=function(){return this}}function T(a){function b(g){return a.next(g)}function e(g){return a.throw(g)}return new Promise(function(g,h){function l(c){c.done?g(c.value):Promise.resolve(c.value).then(b,e).then(l,h)}l(a.next())})}
function U(a){return T(new S(new M(a)))}C("String.prototype.repeat",function(a){return a?a:function(b){if(null==this)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var e=this;if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var g="";b;)if(b&1&&(g+=e),b>>>=1)e+=e;return g}});
function V(a,b){return b=b||{},new Promise(function(e,g){function h(){return{ok:2==(l.status/100|0),statusText:l.statusText,status:l.status,url:l.responseURL,text:function(){return Promise.resolve(l.responseText)},json:function(){return Promise.resolve(JSON.parse(l.responseText))},blob:function(){return Promise.resolve(new Blob([l.response]))},clone:h,headers:{keys:function(){return c},entries:function(){return d},get:function(n){return f[n.toLowerCase()]},has:function(n){return n.toLowerCase()in
f}}}}var l=new XMLHttpRequest,c=[],d=[],f={},k;for(k in l.open(b.method||"get",a,!0),l.onload=function(){l.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(n,p,m){c.push(p=p.toLowerCase());d.push([p,m]);f[p]=f[p]?f[p]+","+m:m});e(h())},l.onerror=g,l.withCredentials="include"==b.credentials,b.headers)l.setRequestHeader(k,b.headers[k]);l.send(b.body||null)})};function W(a){var b,e,g=window.host||"",h={type:"updates"};g=void 0===g?"":g;h=void 0===h?{}:h;var l=void 0===h.path?"subscribe":h.path,c=void 0===h.method?"POST":h.method,d=void 0===h.type?"comments":h.type,f,k,n,p,m,r,v,w,P,Q;return U(function(q){switch(q.a){case 1:return L(q,V(g+"/vapid"),2);case 2:return f=q.c,L(q,f.text(),3);case 3:k=q.c;if(!k)throw Error("Could not fetch vapid key.");var u="=".repeat((4-k.length%4)%4);u=window.atob((k+u).replace(/-/g,"+").replace(/_/g,"/"));for(var z=new Uint8Array(u.length),
A=0;A<u.length;++A)z[A]=u.charCodeAt(A);n=z;return L(q,a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n}),4);case 4:return p=q.c,m=new FormData,u=JSON.parse(JSON.stringify(p)),z=u.keys,b=u.endpoint,e={l:z.p256dh,m:z.auth},r=b,v=e,w=v.l,P=v.m,m.append("endpoint",r),m.append("p256dh",w),m.append("auth",P),m.append(d,"true"),L(q,V(g+"/"+l,{method:c,body:m}),5);case 5:return Q=q.c,L(q,Q.json(),6);case 6:return q.return({l:w})}})};var X=document.getElementById("subscribe-btn");if(X){var Y=X.innerText;X.onclick=function(a){return U(function(b){a.preventDefault();Z();return b.return(!1)})}}function Z(){var a=Y,b,e,g;U(function(h){if(1==h.a)return L(h,navigator.serviceWorker.register("/service-worker.js",{scope:"/"}),2);if(3!=h.a)return b=h.c,L(h,W(b),3);e=h.c;if(g=e.l)X.innerText=a+" \u2705";h.a=0})};

//# sourceMappingURL=subscribe.js.map