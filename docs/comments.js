(function(){function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function k(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function u(a){if(!(a instanceof Array)){a=k(a);for(var b,c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}var ba="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},w;
if("function"==typeof Object.setPrototypeOf)w=Object.setPrototypeOf;else{var ca;a:{var da={M:!0},ea={};try{ea.__proto__=da;ca=ea.M;break a}catch(a){}ca=!1}w=ca?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var fa=w;
function y(a,b){a.prototype=ba(b.prototype);a.prototype.constructor=a;if(fa)fa(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c]}var z="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,ha="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function B(a,b){if(b){var c=z;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ha(c,a,{configurable:!0,writable:!0,value:b})}}
B("Promise",function(a){function b(f){this.b=0;this.i=void 0;this.a=[];var g=this.c();try{f(g.resolve,g.reject)}catch(l){g.reject(l)}}function c(){this.a=null}function d(f){return f instanceof b?f:new b(function(g){g(f)})}if(a)return a;c.prototype.b=function(f){if(null==this.a){this.a=[];var g=this;this.c(function(){g.i()})}this.a.push(f)};var e=z.setTimeout;c.prototype.c=function(f){e(f,0)};c.prototype.i=function(){for(;this.a&&this.a.length;){var f=this.a;this.a=[];for(var g=0;g<f.length;++g){var l=
f[g];f[g]=null;try{l()}catch(m){this.g(m)}}}this.a=null};c.prototype.g=function(f){this.c(function(){throw f;})};b.prototype.c=function(){function f(m){return function(n){l||(l=!0,m.call(g,n))}}var g=this,l=!1;return{resolve:f(this.U),reject:f(this.g)}};b.prototype.U=function(f){if(f===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof b)this.V(f);else{a:switch(typeof f){case "object":var g=null!=f;break a;case "function":g=!0;break a;default:g=!1}g?this.B(f):this.j(f)}};
b.prototype.B=function(f){var g=void 0;try{g=f.then}catch(l){this.g(l);return}"function"==typeof g?this.W(g,f):this.j(f)};b.prototype.g=function(f){this.o(2,f)};b.prototype.j=function(f){this.o(1,f)};b.prototype.o=function(f,g){if(0!=this.b)throw Error("Cannot settle("+f+", "+g+"): Promise already settled in state"+this.b);this.b=f;this.i=g;this.w()};b.prototype.w=function(){if(null!=this.a){for(var f=0;f<this.a.length;++f)h.b(this.a[f]);this.a=null}};var h=new c;b.prototype.V=function(f){var g=this.c();
f.A(g.resolve,g.reject)};b.prototype.W=function(f,g){var l=this.c();try{f.call(g,l.resolve,l.reject)}catch(m){l.reject(m)}};b.prototype.then=function(f,g){function l(r,p){return"function"==typeof r?function(q){try{m(r(q))}catch(v){n(v)}}:p}var m,n,t=new b(function(r,p){m=r;n=p});this.A(l(f,m),l(g,n));return t};b.prototype.catch=function(f){return this.then(void 0,f)};b.prototype.A=function(f,g){function l(){switch(m.b){case 1:f(m.i);break;case 2:g(m.i);break;default:throw Error("Unexpected state: "+
m.b);}}var m=this;null==this.a?h.b(l):this.a.push(l)};b.resolve=d;b.reject=function(f){return new b(function(g,l){l(f)})};b.race=function(f){return new b(function(g,l){for(var m=k(f),n=m.next();!n.done;n=m.next())d(n.value).A(g,l)})};b.all=function(f){var g=k(f),l=g.next();return l.done?d([]):new b(function(m,n){function t(q){return function(v){r[q]=v;p--;0==p&&m(r)}}var r=[],p=0;do r.push(void 0),p++,d(l.value).A(t(r.length-1),n),l=g.next();while(!l.done)})};return b});
function ia(){ia=function(){};z.Symbol||(z.Symbol=ja)}function ka(a,b){this.a=a;ha(this,"description",{configurable:!0,writable:!0,value:b})}ka.prototype.toString=function(){return this.a};var ja=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new ka("jscomp_symbol_"+(c||"")+"_"+b++,c)}var b=0;return a}();
function C(){ia();var a=z.Symbol.iterator;a||(a=z.Symbol.iterator=z.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&ha(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return la(aa(this))}});C=function(){}}function la(a){C();a={next:a};a[z.Symbol.iterator]=function(){return this};return a}function E(){this.o=!1;this.j=null;this.a=void 0;this.b=1;this.i=this.g=0;this.B=this.c=null}function ma(a){if(a.o)throw new TypeError("Generator is already running");a.o=!0}
E.prototype.w=function(a){this.a=a};function na(a,b){a.c={G:b,H:!0};a.b=a.g||a.i}E.prototype.return=function(a){this.c={return:a};this.b=this.i};function F(a,b,c){a.b=c;return{value:b}}E.prototype.v=function(a){this.b=a};function G(a,b,c){a.g=b;void 0!=c&&(a.i=c)}function H(a){a.g=0;var b=a.c.G;a.c=null;return b}function I(a){a.B=[a.c];a.g=0;a.i=0}function J(a,b){var c=a.B.splice(0)[0];(c=a.c=a.c||c)?c.H?a.b=a.g||a.i:void 0!=c.v&&a.i<c.v?(a.b=c.v,a.c=null):a.b=a.i:a.b=b}
function oa(a){this.a=new E;this.b=a}function pa(a,b){ma(a.a);var c=a.a.j;if(c)return qa(a,"return"in c?c["return"]:function(d){return{value:d,done:!0}},b,a.a.return);a.a.return(b);return K(a)}function qa(a,b,c,d){try{var e=b.call(a.a.j,c);if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");if(!e.done)return a.a.o=!1,e;var h=e.value}catch(f){return a.a.j=null,na(a.a,f),K(a)}a.a.j=null;d.call(a.a,h);return K(a)}
function K(a){for(;a.a.b;)try{var b=a.b(a.a);if(b)return a.a.o=!1,{value:b.value,done:!1}}catch(c){a.a.a=void 0,na(a.a,c)}a.a.o=!1;if(a.a.c){b=a.a.c;a.a.c=null;if(b.H)throw b.G;return{value:b.return,done:!0}}return{value:void 0,done:!0}}
function ra(a){this.next=function(b){ma(a.a);a.a.j?b=qa(a,a.a.j.next,b,a.a.w):(a.a.w(b),b=K(a));return b};this.throw=function(b){ma(a.a);a.a.j?b=qa(a,a.a.j["throw"],b,a.a.w):(na(a.a,b),b=K(a));return b};this.return=function(b){return pa(a,b)};C();this[Symbol.iterator]=function(){return this}}function sa(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function h(f){f.done?d(f.value):Promise.resolve(f.value).then(b,c).then(h,e)}h(a.next())})}
function L(a){return sa(new ra(new oa(a)))}function ta(a,b){C();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d}B("Array.prototype.values",function(a){return a?a:function(){return ta(this,function(b,c){return c})}});
B("Object.entries",function(a){return a?a:function(b){var c=[],d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&c.push([d,b[d]]);return c}});function ua(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""}
B("String.prototype.startsWith",function(a){return a?a:function(b,c){var d=ua(this,b,"startsWith"),e=d.length,h=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var f=0;f<h&&c<e;)if(d[c++]!=b[f++])return!1;return f>=h}});B("String.prototype.repeat",function(a){return a?a:function(b){var c=ua(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
B("Array.prototype.keys",function(a){return a?a:function(){return ta(this,function(b){return b})}});try{window.preact=preact}catch(a){window.preact={}}var va=window.preact,M=va.h,N=va.Component,wa=va.render;function xa(a){var b=a.help,c=a.m,d=a.valid,e="text-muted";a.invalid?e="invalid-feedback":d&&(e="valid-feedback");a="form-text "+e;return"string"!=typeof b?M("small",{id:c,className:a},b):M("small",{id:c,className:a,dangerouslySetInnerHTML:{__html:b}})};function Ba(a,b){var c=this.props,d=c.name,e=a.value;if(this.context.values[d]!=b.values[d])return!0;if(c.value!=e){if(b.onChange)b.onChange(a.name,e);return!1}}function Ca(a){var b=[];a=Object.entries(a).reduce(function(c,d){var e=k(d);d=e.next().value;e=e.next().value;if("col"==d||d.startsWith("col-"))return b.push(d),c;c[d]=e;return c},{});return{F:b,S:a}};function O(){var a=N.call(this)||this;a.id="i"+Math.floor(1E5*Math.random());a.m="h"+a.id;a.props=a.props;return a}y(O,N);O.prototype.getChildContext=function(){return{id:this.id,m:this.m}};
O.prototype.render=function(a){var b=Object.assign({},a),c=a.children,d=a.label,e=a.help,h=a.details,f=a.className,g=a["form-row"],l=void 0===a.row?g:a.row;a=a.labelClassName;b=(delete b.children,delete b.label,delete b.help,delete b.details,delete b.className,delete b["form-row"],delete b.row,delete b.labelClassName,b);f=["form-group",f,l?(g?"form-":"")+"row":null].filter(Boolean).join(" ")||void 0;g=Ca(b).F;a=[l?"col-form-label":null,a].concat(u(g)).filter(Boolean).join(" ")||void 0;d=d?M("label",
{className:a,htmlFor:this.id},d):null;e=M(xa,{help:e,m:this.m});return h?M("details",{className:f},M("summary",{},d),c,l?M("div",{className:"col-12"},e):e):M("div",{className:f},d,c,l?M("div",{className:"col-12"},e):e)};function P(){var a=N.call(this)||this;a.props=a.props;return a}y(P,N);P.prototype.shouldComponentUpdate=function(a,b,c){return Ba.call(this,a,c)};P.prototype.componentDidMount=function(){var a=this.props,b=k(a.children).next().value;a=a.name;var c=this.context.onChange;b&&c(a,b.trim())};
P.prototype.render=function(a){var b=Object.assign({},a),c=void 0===a.rows?3:a.rows,d=a.required,e=a.name,h=a.placeholder;a=a.children;b=(delete b.rows,delete b.required,delete b.name,delete b.placeholder,delete b.children,b);var f=this.context,g=f.onChange,l=void 0===f.values?{}:f.values,m=e in l;return M("textarea",Object.assign({},b,{required:d,name:e,placeholder:h,"aria-describedby":f.m,className:"form-control",id:f.id,onChange:function(n){g(e,n.currentTarget.value)},rows:c}),m?l[e]:a)};function Q(){var a=N.call(this)||this;a.props=a.props;return a}y(Q,N);Q.prototype.shouldComponentUpdate=function(a,b,c){return Ba.call(this,a,c)};Q.prototype.componentDidMount=function(){var a=this.props,b=a.value;a=a.name;var c=this.context.onChange;void 0!==b&&c&&c(a,b)};Q.prototype.onChange=function(a){this.context.onChange(this.props.name,a)};
Q.prototype.render=function(a){var b=this,c=Object.assign({},a),d=a.required,e=a.name,h=a.placeholder,f=void 0===a.type?"text":a.type,g=a.file,l=a.value,m=a.className,n=a.invalid,t=a.valid;a=a.help;c=(delete c.required,delete c.name,delete c.placeholder,delete c.type,delete c.file,delete c.value,delete c.className,delete c.invalid,delete c.valid,delete c.help,c);var r=Ca(c);c=r.F;r=r.S;m=["form-control"+(g?"-file":""),m,n?"is-invalid":null,t?"is-valid":null].filter(Boolean).join(" ");var p=this.context;
g=p.m;var q=void 0===p.values?{}:p.values;d=M("input",Object.assign({},r,{required:d,name:e,placeholder:h,className:m,value:e in q?q[e]:l,type:f,"aria-describedby":g,id:p.id,onChange:function(v){b.onChange(v.currentTarget.value)}}));return c.length?(n=a?M(xa,{help:a,m:g,valid:t,invalid:n}):null,M("div",{className:c.join(" ")},d,n)):d};function R(a,b){return b=b||{},new Promise(function(c,d){function e(){return{ok:2==(h.status/100|0),statusText:h.statusText,status:h.status,url:h.responseURL,text:function(){return Promise.resolve(h.responseText)},json:function(){return Promise.resolve(JSON.parse(h.responseText))},blob:function(){return Promise.resolve(new Blob([h.response]))},clone:e,headers:{keys:function(){return f},entries:function(){return g},get:function(n){return l[n.toLowerCase()]},has:function(n){return n.toLowerCase()in
l}}}}var h=new XMLHttpRequest,f=[],g=[],l={},m;for(m in h.open(b.method||"get",a,!0),h.onload=function(){h.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(n,t,r){f.push(t=t.toLowerCase());g.push([t,r]);l[t]=l[t]?l[t]+","+r:r});c(e())},h.onerror=d,h.withCredentials="include"==b.credentials,b.headers)h.setRequestHeader(m,b.headers[m]);h.send(b.body||null)})};function S(){var a=N.call(this)||this;a.props=a.props;a.state={formLoading:!1,error:null,success:null};a.a={};return a}y(S,N);
S.prototype.b=function(a){var b=this,c,d,e,h,f;return L(function(g){switch(g.b){case 1:a.preventDefault();if(!b.props.path)return b.setState({error:"Path is not set in the properties of the form."}),g.return(!1);b.setState({error:null,success:null});c=new FormData(a.target);b.setState({formLoading:!0});G(g,2,3);return F(g,R(b.props.path,Object.assign({},{method:"POST",body:c},b.a)),5);case 5:return d=g.a,F(g,d.json(),6);case 6:e=g.a,(h=e.error)?b.setState({error:h}):b.setState({success:1});case 3:I(g);
b.setState({formLoading:!1});J(g,4);break;case 2:f=H(g);b.setState({error:f});g.v(3);break;case 4:if(!b.props.submitFinish){g.v(7);break}return F(g,b.props.submitFinish(d),7);case 7:return g.return(!1)}})};function U(){var a=N.call(this)||this;a.state={values:{}};a.props=a.props;return a}y(U,N);U.prototype.getChildContext=function(){return{values:this.state.values,onChange:this.onChange.bind(this)}};U.prototype.onChange=function(a,b){var c={};this.setState({values:Object.assign({},this.state.values,(c[a]=b,c))});if(this.props.onChange)this.props.onChange(this.state.values)};
U.prototype.render=function(a){var b=Object.assign({},a),c=a.children,d=a.formRef;a=a.onSubmit;b=(delete b.children,delete b.formRef,delete b.onSubmit,delete b.onChange,b);return M("form",Object.assign({},b,{ref:d,onSubmit:a}),c)};
function Da(a){var b=Object.assign({},a),c=a.disabled,d=a.loading,e=a.confirmText,h=void 0===a.loadingText?e:a.loadingText,f=a.className,g=void 0===a.type?"primary":a.type;a=void 0===a.outline?!1:a.outline;b=(delete b.disabled,delete b.loading,delete b.confirmText,delete b.loadingText,delete b.className,delete b.type,delete b.outline,b);f=["btn","btn-"+(a?"outline-":"")+g,f].filter(Boolean);return M("button",Object.assign({},b,{className:f.join(" "),type:"submit",disabled:c||d}),d&&M("span",{className:"spinner-border spinner-border-sm"+
(h?" mr-2":""),role:"status","aria-hidden":"true"}),d?h:e)};function Ea(a){var b=a.linkedin_user;a=a.github_user;var c;if(b)var d=b.profilePicture;else a&&(d=a.avatar_url);b?c=b.firstName+" "+b.lastName:a&&(c=a.name||a.login);return{J:d,name:c}};function Fa(a){a=JSON.parse(JSON.stringify(a));var b=a.keys;return{endpoint:a.endpoint,keys:{l:b.p256dh,f:b.auth}}}function Ga(a,b){b=void 0===b?"":b;var c,d,e,h,f,g,l;return L(function(m){switch(m.b){case 1:return F(m,a.pushManager.getSubscription(),2);case 2:return c=m.a,G(m,3),d=Fa(c),e=d.keys,h=e.l,F(m,R(b+"/subscriptions?key="+h),5);case 5:return f=m.a,F(m,f.json(),6);case 6:return g=m.a,l=g.comments,m.return({s:l,l:h});case 3:return H(m),m.return(!1)}})}
function Ha(a,b){b=void 0===b?"":b;var c,d,e,h,f,g,l,m,n,t,r;return L(function(p){switch(p.b){case 1:return F(p,R(b+"/vapid"),2);case 2:return c=p.a,F(p,c.text(),3);case 3:d=p.a;if(!d)throw Error("Could not fetch vapid key.");var q="=".repeat((4-d.length%4)%4);q=window.atob((d+q).replace(/-/g,"+").replace(/_/g,"/"));for(var v=new Uint8Array(q.length),x=0;x<q.length;++x)v[x]=q.charCodeAt(x);e=v;return F(p,a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e}),4);case 4:return h=p.a,f=
new FormData,g=Fa(h),l=g.endpoint,m=g.keys,n=m.l,t=m.f,f.append("endpoint",l),f.append("p256dh",n),f.append("auth",t),f.append("comments","true"),F(p,R(b+"/subscribe",{method:"POST",body:f}),5);case 5:return r=p.a,F(p,r.json(),6);case 6:return p.return({l:n})}})};function V(){return N.apply(this,arguments)||this}y(V,N);function Ia(){var a;return L(function(b){if(1==b.b)return F(b,navigator.serviceWorker.register("/service-worker.js",{scope:"/"}),2);a=b.a;return b.return(a)})}
V.prototype.componentDidMount=function(){var a=this,b,c,d,e;return L(function(h){switch(h.b){case 1:return a.setState({loading:!0}),h.g=0,h.i=2,F(h,Ia(),4);case 4:return b=h.a,F(h,Ga(b,a.props.host),5);case 5:c=h.a,d=c.s,e=c.l,d&&a.setState({l:e});case 2:I(h),a.setState({loading:!1}),J(h,0)}})};
V.prototype.subscribe=function(){var a=this,b,c,d;return L(function(e){switch(e.b){case 1:return a.setState({loading:!0}),e.g=0,e.i=2,F(e,Ia(),4);case 4:return b=e.a,F(e,Ha(b,a.props.host),5);case 5:c=e.a,d=c.l,a.setState({l:d});case 2:I(e),a.setState({loading:!1}),J(e,0)}})};
function Ja(a){var b,c,d,e,h;L(function(f){switch(f.b){case 1:b=a.state;c=b.l;if(!c)return f.return();a.setState({loading:!0});f.g=0;f.i=2;return F(f,fetch(a.props.host+"/unsubscribe?comments=true&key="+c),4);case 4:return d=f.a,F(f,d.json(),5);case 5:e=f.a,h=e.comments,!1===h&&a.setState({l:void 0});case 2:I(f),a.setState({loading:!1}),J(f,0)}})}
V.prototype.render=function(a){var b=this;a=a.disabled;var c=this.state,d=c.l;c=c.loading;return M(O,{"form-row":!0,"col-2":!0,label:"Subscribe",help:"Receive push notifications with replies."},M("div",{className:"col-10"},M("div",{className:"form-check col-4"},M("input",{checked:a?!1:d,onChange:function(e){if(e.currentTarget.checked)b.subscribe();else{if(!window.confirm("Are you sure you want so unsubscribe? You will stop receiving notifications from ALL comments on the website."))return e.currentTarget.checked=
!0;Ja(b)}},disabled:a,type:"checkbox",className:"form-check-input",id:"subscribe"}),M("label",{className:"form-check-label",htmlFor:"subscribe"},!a&&c&&M("span",{style:"color:grey"},"Checking your subscriptions..."),!a&&!c&&d&&M("span",{style:"color:green"},"You've subscribed \ud83d\udc4d")),M("input",{value:d,name:"sub-id",type:"hidden"}))))};function W(){var a=S.call(this)||this;a.a={credentials:"include"};a.state.N=void 0;return a}y(W,S);W.prototype.componentWillMount=function(){var a=this,b,c,d;return L(function(e){switch(e.b){case 1:return G(e,2),F(e,fetch("https://freegeoip.app/json/",{}),4);case 4:return b=e.a,F(e,b.json(),5);case 5:c=e.a;(d=c.country_code)&&a.setState({N:d});e.b=0;e.g=0;break;case 2:H(e),e.b=0}})};
W.prototype.render=function(a){var b=this,c=Object.assign({},a),d=a.onChange;a=a.f;c=(delete c.onChange,delete c.f,c);var e=this.context,h=e.host,f=e.C,g=e.K;e=void 0===e.replyTo?{}:e.replyTo;var l=e.id;e=e.name;var m=this.state,n=m.formLoading,t=m.error;m=m.success;var r=Ea(a),p=r.J;r=r.name;return M(U,Object.assign({},c,{onSubmit:this.b.bind(this),onChange:function(q){b.setState({error:null,success:null});d&&d(q)}}),p&&M(Q,{value:p,type:"hidden",name:"photo"}),M(Q,{value:a.csrf,type:"hidden",name:"csrf"}),
M(O,{"form-row":!0,"col-2":!0,label:"Name*",help:"This will appear on the website"},M(Q,{disabled:!f,value:r,"col-10":!0,name:"name"})),M(O,{help:a.github_user?"GitHub username, sign out to remove":"Please sign in with GitHub","form-row":!0,"col-2":!0,label:"GitHub"},M(Q,{value:a.github_user?a.github_user.html_url:null,"col-5":!0,name:"github",disabled:!0}),a.github_user&&M("div",{className:"form-check form-check-inline col-4"},M("input",{type:"checkbox",className:"form-check-input",id:"defaultCheck2",
name:"hide-github"}),M("label",{className:"form-check-label",htmlFor:"defaultCheck2"},"Hide from public"))),M(O,{"form-row":!0,"col-2":!0,label:"Comment*",help:"Please enter your opinion"},M("div",{className:"col-10"},M(P,{disabled:!f,"data-id":"comment-text-area",required:!0,name:"comment"},e&&e+", ","I think you're right/wrong because..."),l&&M("input",{value:l,type:"hidden",name:"reply-to"})),l&&M("div",{className:"col-10"},"You're replying to ",M("a",{onClick:function(q){q.preventDefault();document.querySelector('[data-comment="'+
l+'"]').scrollIntoView({behavior:"smooth"});return!1},href:"#"},e,".")," ",M("a",{onClick:function(q){q.preventDefault();g(null);return!1},href:"#"},"Clear response"))),M(V,{disabled:!f,host:h}),M(Da,{disabled:!f,loading:n,type:"warning",confirmText:"Submit Data"}),t&&"Error: "+t,m&&"Comment has been submitted!")};function Ka(a,b,c){function d(){var m=[],n=[],t={},r;g.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(p,q,v){m.push(q=q.toLowerCase());n.push([q,v]);r=t[q];t[q]=r?r+","+v:v});return{ok:2==(g.status/100|0),status:g.status,statusText:g.statusText,url:g.responseURL,clone:d,text:function(){return g.responseText},json:function(){return JSON.parse(g.responseText)},blob:function(){return new Blob([g.response])},headers:{keys:function(){return m},entries:function(){return n},get:function(p){return t[p.toLowerCase()]},
has:function(p){return p.toLowerCase()in t}}}}c=void 0===c?{}:c;var e=void 0===c.headers?{}:c.headers,h=c.credentials,f=void 0===c.body?null:c.body,g=new XMLHttpRequest;g.open(void 0===c.method?"get":c.method,a,!0);for(var l in e)g.setRequestHeader(l,e[l]);g.withCredentials="include"==h;g.onload=function(){b(null,d())};g.onerror=function(){b("Could not load the resource at "+a+".")};g.send(f)};function X(){var a=N.call(this)||this;a.state={loading:!0,error:null,f:{}};a.a=a.b.bind(a);window.addEventListener("message",a.a,!1);return a}y(X,N);X.prototype.componentDidMount=function(){this.f()};X.prototype.f=function(){var a=this;this.setState({loading:!0});Ka(this.props.host+"/auth",function(b,c){a.setState({loading:!1});if(b)return a.setState({error:b});b=c.json();a.setState({f:b})},{credentials:"include"})};X.prototype.b=function(a){a.origin==this.props.host&&"signedin"==a.data&&this.f()};
X.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.a)};function La(a){var b=void 0===b?{}:b;var c=window.top,d=c.outerHeight,e=c.screenY,h=[];h.push("width=500","left="+(c.outerWidth/2+c.screenX-250));h.push("top="+(d/2+e-305-50),"height=610");c=Object.keys(b).map(function(f){return f+"="+b[f]});h.push.apply(h,u(c));window.open(a,"Sign In",h.join(","))};function Ma(a){a=void 0===a?"":a;var b=document.head,c=document.createElement("style");c.type="text/css";c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a));b.appendChild(c)};Ma(".LinkedInButton {\n  background: #0077B5;\n  display: inline-table;\n  border-radius: 3px;\n  font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\n  text-decoration: none;\n  color: white !important;\n  cursor: pointer;\n}\n.LinkedInButton .LinkedInIn {\n  font-family: 'Myriad Pro', 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif;\n  padding-left: 6px;\n  padding-right: 5px;\n  border-right: 1px solid #0369A0;\n  border-radius: 3px;\n  font-weight: 600;\n  background: #0077B5;\n  display: table-cell;\n  vertical-align: middle;\n}\n.LinkedInButton .LinkedInText {\n  padding-left: .5em;\n  padding-right: .5em;\n  font-size: smaller;\n  display: table-cell;\n  vertical-align: middle;\n}");function Na(a){var b=void 0===a.size?"medium":a.size,c=a.host,d=void 0===a.D?"/linkedin":a.D,e;"medium"==b?e=1.5:"large"==b&&(e=2);return M("a",{onClick:function(h){h.preventDefault();La(""+c+d);return!1},onMouseOver:function(h){h.currentTarget.style.background="#0369A0"},onMouseOut:function(h){h.currentTarget.style.background="#0077B5"},className:"LinkedInButton"},M("div",{style:"font-size:"+e+"rem;",className:"LinkedInIn"},"in"),M("div",{className:"LinkedInText"},"Sign In With LinkedIn"))};function Oa(a){return M("svg",Object.assign({},a,{role:"img",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}),M("title",{},"GitHub icon"),M("path",{d:"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}))}
;Ma(".GitHubButton {\n  background: #dfdfdf;\n  display: inline-table;\n  border-radius: 3px;\n  font-family: Helvetica Neue,Helvetica,Arial,sans-serif;\n  text-decoration: none;\n  color: black !important;\n  cursor: pointer;\n}\n.GitHubButton .GitHubLogo {\n  padding: 0px 6px 0px 5px;\n  border-right: 1px solid #bcbcbc;\n  border-radius: 3px;\n  font-weight: 600;\n  background: rgb(223, 223, 223);\n  display: table-cell;\n  vertical-align: middle;\n}\n.GitHubButton .GitHubText {\n  padding-left: .5em;\n  padding-right: .5em;\n  font-size: smaller;\n  display: table-cell;\n  vertical-align: middle;\n}");function Pa(a){var b=void 0===a.size?"medium":a.size,c=a.host,d=void 0===a.D?"/github":a.D,e;"medium"==b?e=1.5:"large"==b&&(e=2);return M("a",{onClick:function(h){h.preventDefault();La(""+c+d);return!1},onMouseOver:function(h){h.currentTarget.style.background="#bcbcbc"},onMouseOut:function(h){h.currentTarget.style.background="#DFDFDF"},className:"GitHubButton"},M("div",{style:"height:"+e+"rem;font-size:"+e+"rem",className:"GitHubLogo"},M(Oa,{height:"100%",style:"margin-top:-4px"})),M("div",{className:"GitHubText"},
"Sign In With GitHub"))};function Qa(a,b,c){var d=new FormData;d.append("csrf",b);Ka(a+"/signout",function(e,h){if(e)return c(e);e=h.json().error;c(e)},{method:"POST",headers:{X:"application/json"},body:d,credentials:"include"})}
function Ra(a){var b=a.f,c=void 0===a.I?function(){}:a.I,d=a.host;a=b.github_user;var e=b.csrf;if(!b.linkedin_user&&!a)return null;b=Ea(b);a=b.name;return M("div",{},M("img",{src:b.J,width:"50",style:"padding-right:.5rem;"}),"Hello, ",a,"!"," ",M("a",{onClick:function(h){h.preventDefault();Qa(d,e,function(f){f?alert("Could not sign out: "+f+". Please refresh the page and try again. Alternatively, clear your cookies."):c()});return!1},href:"#"},"Sign Out"))};function Sa(a){var b=a.error,c=a.loading,d=a.f,e=a.R;a=a.host;return b?M("div",{},"Error: ",b):c?M("div",{},"Loading..."):M("div",{},!(d.linkedin_user||d.github_user)&&M("span",{style:"display:block"},"Please sign in to leave comments. No advanced permissions are required other than default ones (no email). Your public LinkedIn ID remains unknown. ",M("a",{href:"/privacy-policy.html"},"Privacy Policy")),M(Ra,{f:d,I:e,host:a}),!d.linkedin_user&&M(Na,{host:a}),!d.linkedin_user&&" ",!d.github_user&&
M(Pa,{host:a}))};Ma(".LCommentBlock {\n  display:table;\n  hyphens:auto;\n  -webkit-hyphens:auto;\n  word-break:break-word;\n}\n.LCommentBlock > div {\n  display: table-cell;\n  vertical-align: middle;\n}\n.LCommentBlock img {\n  margin-right: .5rem;\n  border-radius: 1.75rem;\n  width: 3.5rem;\n}");function Y(){var a=N.call(this)||this;a.state={s:[],page:0,csrf:null};return a}y(Y,N);Y.prototype.componentDidMount=function(){this.fetch()};
Y.prototype.fetch=function(a,b){var c=this,d,e,h,f,g,l,m,n,t,r,p;return L(function(q){switch(q.b){case 1:c.setState({loading:!0});d=c.context;e=d.host;h=c.props;f=h.T;var v={id:a,"reply-to":f,"last-comment-id":b},x=[],D;for(D in v)if(v.hasOwnProperty(D)){var T=v[D];void 0!==T&&x.push(encodeURIComponent(D)+"="+encodeURIComponent(T))}v=x.join("&");g=v.length?"?"+v:"";G(q,2,3);return F(q,R(e+"/json-comments"+g,{credentials:"include"}),5);case 5:return l=q.a,F(q,l.json(),6);case 6:m=q.a,n=m.comments,
t=m.csrf,r=b?u(c.state.s).concat(u(n)):u(n).concat(u(c.state.s)),c.setState({s:r,csrf:t});case 3:I(q);c.setState({loading:!1});J(q,0);break;case 2:p=H(q),c.setState({error:p.message}),q.v(3)}})};
Y.prototype.render=function(a){var b=this;a=void 0===a.L?Infinity:a.L;var c=this.state,d=c.error,e=c.loading,h=c.s,f=c.csrf;console.log(a,h.length);return d?M("div",{},"Error loading list: ",d):M("div",{className:"CommentsList"},h.map(function(g){return M(Ta,{list:b,key:g._id,comment:g,csrf:f,P:function(l){b.setState({s:h.filter(function(m){return m._id!=l})})}})}),e&&M("div",{},"Loading list..."),!h.length&&M("div",{},"No comments yet."),!!h.length&&a>h.length&&M("a",{onClick:function(g){g.preventDefault();
b.fetch(void 0,h[h.length-1]._id);return!1},href:"#"},"Load more"))};function Ua(a){return(a=a.github_user)?M("span",{}," (",M("a",{href:a.html_url},a.login),")"):null}function Ta(){var a=N.call(this)||this;a.list=null;return a}y(Ta,N);
Ta.prototype.render=function(a){var b=this,c=a.comment,d=c._id,e=c.country,h=c.isAuthor,f=c.name,g=c.photo,l=c.comment,m=c.date,n=c.github_user;c=c.replies;var t=a.P,r=a.csrf;a=this.context;var p=a.C,q=a.host,v=a.K;a=this.state.u;return M("div",{className:"comment"},M("strong",{},f||"Anonymous"),M(Ua,{github_user:n}),e?" from "+e:""," ","on ",M("em",{},(new Date(m)).toLocaleString())," ",h&&M("a",{onClick:function(x){var D,T,ya,za,Aa;return L(function(A){switch(A.b){case 1:x.preventDefault();D=confirm("Are you sure you want to delete comment?");
if(!D)return A.return(!1);G(A,2);return F(A,R(q+"/remove-comment?csrf="+r+"&id="+d,{credentials:"include"}),4);case 4:return T=A.a,F(A,T.json(),5);case 5:ya=A.a;(za=ya.error)?alert(za):t(d);A.b=3;A.g=0;break;case 2:Aa=H(A),alert(Aa.message);case 3:return A.return(!1)}})},className:"badge badge-danger",href:"#"},"Remove")," ",M("a",{style:p?void 0:"color:grey",className:"badge badge-primary",href:"#",onClick:function(x){x.preventDefault();p?v({id:d,name:f,u:function(D){b.list?b.list.fetch(D):b.setState({u:!0})}}):
alert("Please sign in to reply");return!1}},"Reply"),M("div",{"data-comment":d,className:"LCommentBlock"},g&&M("div",{},M("img",{src:g})),M("div",{},l,!a&&M(Va,{O:function(x){x.preventDefault();b.setState({u:!0});return!1},replies:c}))),a&&M("div",{"data-comment":d,className:"LCommentBlock"},M("div",{style:"width:50px;"}),M("div",{},M(Y,{ref:function(x){b.list=x},T:d,L:c}))))};function Va(a){var b=a.replies;return b?M("div",{},M("a",{onClick:a.O,href:"#"},"Load ",b," repl",1<b?"ies":"y")):null};function Z(){var a=X.call(this)||this;a.list=null;a.state={f:{}};return a}y(Z,X);Z.prototype.getChildContext=function(){var a=this;return{C:this.C,host:this.props.host,replyTo:this.state.replyTo,K:function(b){if(null===b)a.setState({replyTo:void 0});else{var c=b.id,d=b.name;b=b.u;document.querySelector('[data-id="comment-text-area"]').scrollIntoView({behavior:"smooth"});a.setState({replyTo:{id:c,name:d,u:b}})}}}};
Z.prototype.render=function(){var a=this,b=this.state,c=b.f;return M("div",{},M(Sa,{error:b.error,loading:b.loading,f:c,host:this.props.host,R:function(){a.setState({f:{}})}}),M(W,{path:this.props.host+"/comment",f:c,submitFinish:function(d){var e,h,f,g,l,m;return L(function(n){if(1==n.b)return F(n,d.json(),2);e=n.a;h=e.error;f=e.id;if(!h&&f){debugger;g=a.state;l=void 0===g.replyTo?{}:g.replyTo;(m=l.u)?m(f):a.list&&a.list.fetch(f)}n.b=0})}}),M(Y,{ref:function(d){a.list=d}}))};
z.Object.defineProperties(Z.prototype,{C:{configurable:!0,enumerable:!0,get:function(){var a=this.state.f;return a.github_user||a.linkedin_user}}});window.comments=function(a){var b=void 0===a.container?"preact":a.container;wa(M(Z,{host:void 0===a.host?"https://api.artd.eco":a.host}),document.getElementById(b))};}).call(this);

//# sourceMappingURL=comments.js.map